<div class="add-track-container">
  <h2>Ajouter une nouvelle piste</h2>

  <form [formGroup]="trackForm" (ngSubmit)="onSubmit()">

    <div class="form-group">
      <label for="title">Titre de la chanson *</label>
      <input 
        id="title" 
        type="text" 
        formControlName="title" 
        placeholder="Ex: Shape of You"
      >
      @if (trackForm.get('title')?.touched && trackForm.get('title')?.invalid) {
        <small class="error">Le titre est obligatoire (max 50 caractères)</small>
      }
    </div>

    <div class="form-group">
      <label for="artist">Artiste *</label>
      <input 
        id="artist" 
        type="text" 
        formControlName="artist" 
        placeholder="Ex: Ed Sheeran"
      >
      @if (trackForm.get('artist')?.touched && trackForm.get('artist')?.invalid) {
        <small class="error">Le nom de l'artiste est obligatoire</small>
      }
    </div>

    <div class="form-group">
      <label for="genre">Genre *</label>
      <select id="genre" formControlName="genre">
        <option value="Pop">Pop</option>
        <option value="Rock">Rock</option>
        <option value="Rap">Rap</option>
        <option value="Jazz">Jazz</option>
        <option value="Classical">Classical</option>
      </select>
    </div>

    <div class="form-group">
      <label for="description">Description</label>
      <textarea 
        id="description" 
        formControlName="description" 
        rows="3"
        placeholder="Une petite description..."
      ></textarea>
      @if (trackForm.get('description')?.hasError('maxlength')) {
        <small class="error">Maximum 200 caractères</small>
      }
    </div>

    <div class="form-group file-upload">
      <label for="audioFile">Fichier Audio (MP3, WAV, OGG) *</label>
      <input 
        #fileInput
        id="audioFile" 
        type="file" 
        accept="audio/*"
        (change)="onFileSelected(fileInput)"
      >
      
      @if (fileError()) {
        <div class="alert-error">
          {{ fileError() }}
        </div>
      }

      @if (fileDuration > 0) {
        <div class="success-info">
          ✅ Durée détectée: {{ fileDuration }} secondes
        </div>
      }
    </div>

    <div class="actions">
      <button 
        type="submit" 
        class="btn-save" 
        [disabled]="trackForm.invalid || !selectedFile || isSubmiting()"
      >
        @if (isSubmiting()) {
          <span>Sauvegarde en cours...</span>
        } @else {
          <span>Enregistrer</span>
        }
      </button>
      
      <button type="button" class="btn-cancel" routerLink="/library">Annuler</button>
    </div>

  </form>
</div>